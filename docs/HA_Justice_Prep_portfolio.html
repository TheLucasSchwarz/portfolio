<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.533">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lucas Schwarz">
<meta name="dcterms.date" content="2024-03-20">

<title>From Tax to Equality</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="HA_Justice_Prep_portfolio_files/libs/clipboard/clipboard.min.js"></script>
<script src="HA_Justice_Prep_portfolio_files/libs/quarto-html/quarto.js"></script>
<script src="HA_Justice_Prep_portfolio_files/libs/quarto-html/popper.min.js"></script>
<script src="HA_Justice_Prep_portfolio_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HA_Justice_Prep_portfolio_files/libs/quarto-html/anchor.min.js"></script>
<link href="HA_Justice_Prep_portfolio_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HA_Justice_Prep_portfolio_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HA_Justice_Prep_portfolio_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HA_Justice_Prep_portfolio_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HA_Justice_Prep_portfolio_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="HA_Justice_Prep_portfolio_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="HA_Justice_Prep_portfolio_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#einführung-in-den-replikationsbericht" id="toc-einführung-in-den-replikationsbericht" class="nav-link active" data-scroll-target="#einführung-in-den-replikationsbericht"><span class="header-section-number">1</span> Einführung in den Replikationsbericht</a>
  <ul class="collapse">
  <li><a href="#verwendung-des-berichts-als-html" id="toc-verwendung-des-berichts-als-html" class="nav-link" data-scroll-target="#verwendung-des-berichts-als-html"><span class="header-section-number">1.1</span> Verwendung des Berichts als HTML</a></li>
  <li><a href="#verwendung-des-quarto-dokuments-ha_justice.qmd-in-rstudio" id="toc-verwendung-des-quarto-dokuments-ha_justice.qmd-in-rstudio" class="nav-link" data-scroll-target="#verwendung-des-quarto-dokuments-ha_justice.qmd-in-rstudio"><span class="header-section-number">1.2</span> Verwendung des Quarto-Dokuments (HA_Justice.qmd) in RStudio</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"><span class="header-section-number">2</span> Setup</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">3</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#import-datasets" id="toc-import-datasets" class="nav-link" data-scroll-target="#import-datasets"><span class="header-section-number">3.1</span> Import Datasets</a>
  <ul class="collapse">
  <li><a href="#import-wid-dataset" id="toc-import-wid-dataset" class="nav-link" data-scroll-target="#import-wid-dataset"><span class="header-section-number">3.1.1</span> Import WID Dataset</a></li>
  <li><a href="#import-oecd-tax-revenue-data" id="toc-import-oecd-tax-revenue-data" class="nav-link" data-scroll-target="#import-oecd-tax-revenue-data"><span class="header-section-number">3.1.2</span> Import OECD Tax Revenue Data</a></li>
  <li><a href="#import-world-bank-indicators" id="toc-import-world-bank-indicators" class="nav-link" data-scroll-target="#import-world-bank-indicators"><span class="header-section-number">3.1.3</span> Import World Bank Indicators</a></li>
  <li><a href="#import-gc-tax-dataset" id="toc-import-gc-tax-dataset" class="nav-link" data-scroll-target="#import-gc-tax-dataset"><span class="header-section-number">3.1.4</span> Import GC Tax Dataset</a></li>
  <li><a href="#import-vdem-data" id="toc-import-vdem-data" class="nav-link" data-scroll-target="#import-vdem-data"><span class="header-section-number">3.1.5</span> Import VDEM Data</a></li>
  <li><a href="#import-welfare-regimes" id="toc-import-welfare-regimes" class="nav-link" data-scroll-target="#import-welfare-regimes"><span class="header-section-number">3.1.6</span> Import Welfare Regimes</a></li>
  </ul></li>
  <li><a href="#merge-datasets" id="toc-merge-datasets" class="nav-link" data-scroll-target="#merge-datasets"><span class="header-section-number">3.2</span> Merge Datasets</a></li>
  <li><a href="#perfom-multiple-imputation" id="toc-perfom-multiple-imputation" class="nav-link" data-scroll-target="#perfom-multiple-imputation"><span class="header-section-number">3.3</span> Perfom Multiple Imputation</a></li>
  <li><a href="#removing-outliers" id="toc-removing-outliers" class="nav-link" data-scroll-target="#removing-outliers"><span class="header-section-number">3.4</span> Removing Outliers</a></li>
  <li><a href="#balancing-the-datasets" id="toc-balancing-the-datasets" class="nav-link" data-scroll-target="#balancing-the-datasets"><span class="header-section-number">3.5</span> Balancing the datasets</a></li>
  </ul></li>
  <li><a href="#desciptive-statistics" id="toc-desciptive-statistics" class="nav-link" data-scroll-target="#desciptive-statistics"><span class="header-section-number">4</span> Desciptive Statistics</a>
  <ul class="collapse">
  <li><a href="#summary-stats-of-the-equaltax-dataset" id="toc-summary-stats-of-the-equaltax-dataset" class="nav-link" data-scroll-target="#summary-stats-of-the-equaltax-dataset"><span class="header-section-number">4.1</span> Summary Stats of the Equaltax Dataset</a></li>
  <li><a href="#graphical-setup" id="toc-graphical-setup" class="nav-link" data-scroll-target="#graphical-setup"><span class="header-section-number">4.2</span> Graphical Setup</a></li>
  <li><a href="#descriptive-graphs" id="toc-descriptive-graphs" class="nav-link" data-scroll-target="#descriptive-graphs"><span class="header-section-number">4.3</span> Descriptive Graphs</a></li>
  </ul></li>
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models"><span class="header-section-number">5</span> Regression Models</a>
  <ul class="collapse">
  <li><a href="#deciding-for-a-specific-model" id="toc-deciding-for-a-specific-model" class="nav-link" data-scroll-target="#deciding-for-a-specific-model"><span class="header-section-number">5.1</span> Deciding for a specific model</a></li>
  <li><a href="#summary-thoughts-of-the-modelling-decision" id="toc-summary-thoughts-of-the-modelling-decision" class="nav-link" data-scroll-target="#summary-thoughts-of-the-modelling-decision"><span class="header-section-number">5.2</span> Summary Thoughts of the Modelling Decision</a></li>
  <li><a href="#se-correction-tests" id="toc-se-correction-tests" class="nav-link" data-scroll-target="#se-correction-tests"><span class="header-section-number">5.3</span> SE Correction Tests</a>
  <ul class="collapse">
  <li><a href="#arellano-standard-errors-ase-fe-models" id="toc-arellano-standard-errors-ase-fe-models" class="nav-link" data-scroll-target="#arellano-standard-errors-ase-fe-models"><span class="header-section-number">5.3.1</span> Arellano standard errors (ASE)-FE-Models</a></li>
  <li><a href="#panel-corrected-standard-errors-pcse-fe-models" id="toc-panel-corrected-standard-errors-pcse-fe-models" class="nav-link" data-scroll-target="#panel-corrected-standard-errors-pcse-fe-models"><span class="header-section-number">5.3.2</span> Panel corrected standard errors (PCSE)-FE-Models</a></li>
  <li><a href="#driscoll-and-kraay-standard-errors-dkse-fe-models" id="toc-driscoll-and-kraay-standard-errors-dkse-fe-models" class="nav-link" data-scroll-target="#driscoll-and-kraay-standard-errors-dkse-fe-models"><span class="header-section-number">5.3.3</span> Driscoll and Kraay standard errors (DKSE)-FE-Models</a></li>
  <li><a href="#lagged-dependent-variable-model" id="toc-lagged-dependent-variable-model" class="nav-link" data-scroll-target="#lagged-dependent-variable-model"><span class="header-section-number">5.3.4</span> Lagged Dependent Variable Model</a></li>
  <li><a href="#create-regtable-a1-with-model-comparison" id="toc-create-regtable-a1-with-model-comparison" class="nav-link" data-scroll-target="#create-regtable-a1-with-model-comparison"><span class="header-section-number">5.3.5</span> Create RegTable A1 with Model Comparison</a></li>
  </ul></li>
  <li><a href="#main-model-stack" id="toc-main-model-stack" class="nav-link" data-scroll-target="#main-model-stack"><span class="header-section-number">5.4</span> Main Model Stack</a>
  <ul class="collapse">
  <li><a href="#regtable-of-main-models-1-4" id="toc-regtable-of-main-models-1-4" class="nav-link" data-scroll-target="#regtable-of-main-models-1-4"><span class="header-section-number">5.4.1</span> RegTable of Main Models 1-4</a></li>
  </ul></li>
  <li><a href="#wealth-model-stack---minimal-dataset--standarized-models" id="toc-wealth-model-stack---minimal-dataset--standarized-models" class="nav-link" data-scroll-target="#wealth-model-stack---minimal-dataset--standarized-models"><span class="header-section-number">5.5</span> Wealth Model Stack - Minimal Dataset- Standarized Models</a>
  <ul class="collapse">
  <li><a href="#regtable-of-standardized-models-1-4" id="toc-regtable-of-standardized-models-1-4" class="nav-link" data-scroll-target="#regtable-of-standardized-models-1-4"><span class="header-section-number">5.5.1</span> RegTable of Standardized Models 1-4</a></li>
  </ul></li>
  <li><a href="#alternative-lag-tests" id="toc-alternative-lag-tests" class="nav-link" data-scroll-target="#alternative-lag-tests"><span class="header-section-number">5.6</span> Alternative Lag Tests</a>
  <ul class="collapse">
  <li><a href="#regtable-of-causality-models-1-4" id="toc-regtable-of-causality-models-1-4" class="nav-link" data-scroll-target="#regtable-of-causality-models-1-4"><span class="header-section-number">5.6.1</span> RegTable of Causality Models 1-4</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#additional-regression-diagnostics" id="toc-additional-regression-diagnostics" class="nav-link" data-scroll-target="#additional-regression-diagnostics"><span class="header-section-number">6</span> Additional Regression diagnostics</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">From Tax to Equality</h1>
<p class="subtitle lead">Replikationsberichtfile für die Masterhausarbeit im Modul 3: Normative und positive politische Theorie</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lucas Schwarz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 20, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="einführung-in-den-replikationsbericht" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Einführung in den Replikationsbericht</h1>
<section id="verwendung-des-berichts-als-html" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="verwendung-des-berichts-als-html"><span class="header-section-number">1.1</span> Verwendung des Berichts als HTML</h2>
<p>Dieses HTML-Dokument wurde mit Quarto für R erstellt. Diese HTML-Datei kann über Firefox oder jeden chromium-basierten Browser (Google Chrome, Microsoft Edge, etc) lokal und sicher geöffnet werden. Mit dieser kann jeder Schritt der Analyse nachvollzogen werden. An der Rechten Seite kann mithilfe des interaktiven Inhaltsverzeichnisses einfach zu den verschiedenen Kapiteln navigiert werden.</p>
</section>
<section id="verwendung-des-quarto-dokuments-ha_justice.qmd-in-rstudio" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="verwendung-des-quarto-dokuments-ha_justice.qmd-in-rstudio"><span class="header-section-number">1.2</span> Verwendung des Quarto-Dokuments (HA_Justice.qmd) in RStudio</h2>
<p>Das qmd. sollte in der Lage sein, den finalen Datensatz “equaltax_balanced.csv” beim Ausführen in RStudio aus dem Verzeichnis zu importieren und alle Berechnungen auszuführen. Zudem können im HTML-Dokument die Ergebnisse der Berechnungen eingesehen und alle Schritte nachvollzogen werden. Während des Bearbeitungsprozesses wurden diverse Datensetze getestet in verschiedenen Konfigurationen. Überbleibsel davon sind noch im Code vorhanden. Der korrekte Datensatz, der zur Analyse benutzt wurde, wurde am Ende des Kapitel “Data Preparation” erstellt. Dieser kann ab Kapitel 3 “Descriptive Statistics” einfach importiert werden und für alle folgenden Analysen verwendet werden. Der Vorbereitungscode muss daher nicht extra ausgeführt werden.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Wichtig</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Dazu muss der gesamte Ordner “Schwarz_TaxtoEquality_HA-Replikation” als Projekt in R geöffnet werden und dieser zuvor vollständig heruntergeladen worden sein.</strong></p>
</div>
</div>
</section>
</section>
<section id="setup" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setup</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github('Mikata-Project/ggthemr')</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) {<span class="fu">install.packages</span>(<span class="st">"pacman"</span>);<span class="fu">library</span>(pacman)}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(here, tidyverse, countrycode, readxl, scales, patchwork, readxl, rio, plm, lmtest, vdemdata, wid, sjPlot, vtable, Amelia, stargazer, sandwich)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preparation" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Preparation</h1>
<section id="import-datasets" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="import-datasets"><span class="header-section-number">3.1</span> Import Datasets</h2>
<section id="import-wid-dataset" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="import-wid-dataset"><span class="header-section-number">3.1.1</span> Import WID Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("WIDworld/wid-r-tool")</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the specific function for low code download of the WID dataset</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>wid_downloader <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, population, name){</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span>  <span class="fu">download_wid</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">indicators =</span> indicator,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">areas =</span> <span class="st">"all"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">years =</span> <span class="st">"all"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">perc =</span> population,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ages =</span> <span class="st">"992"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pop =</span> <span class="st">"j"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">metadata =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">include_extrapolations =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  filtered_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename_with</span>(<span class="sc">~</span> name, <span class="at">.cols =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>variable, <span class="sc">-</span>percentile)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"WID_"</span>, name)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(var_name, filtered_df, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the indicators</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Wealth Inequality Measures</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"ghweal"</span>, <span class="st">"p0p100"</span>, <span class="st">"Wealth_Gini"</span>) <span class="co"># Wealth Gini coefficients</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"shweal"</span>, <span class="st">"p0p50"</span>, <span class="st">"Wealth_Share_bottom50"</span>) <span class="co"># Wealth Share of the bottom 50%</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"shweal"</span>, <span class="st">"p90p100"</span>, <span class="st">"Wealth_Share_top10"</span>) <span class="co"># Wealth Share of the top 10%</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"shweal"</span>, <span class="st">"p99p100"</span>, <span class="st">"Wealth_Share_top1"</span>) <span class="co"># Wealth Share of the top 1%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Income Inequality Measures</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"gdiinc"</span>, <span class="st">"p0p100"</span>, <span class="st">"IncomePost_Gini"</span>) <span class="co"># Post-tax income Gini coefficients</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"gptinc"</span>, <span class="st">"p0p100"</span>, <span class="st">"IncomePre_Gini"</span>) <span class="co"># Pre-tax income Gini coefficients</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"scainc"</span>, <span class="st">"p0p50"</span>, <span class="st">"IncomeDispPost_Share_bottom50"</span>) <span class="co"># Post-tax disposale income share of the bottom 50%</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"scainc"</span>, <span class="st">"p90p100"</span>, <span class="st">"IncomeDispPost_Share_top10"</span>) <span class="co"># Post-tax disposale income share of the top 10%</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="fu">wid_downloader</span>(<span class="st">"scainc"</span>, <span class="st">"p99p100"</span>, <span class="st">"IncomeDispPost_Share_top1"</span>) <span class="co"># Post-tax disposale income share of the top 1%</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Join all the dataframes</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>WID_dfs_full <span class="ot">&lt;-</span> <span class="fu">list</span>(WID_Wealth_Gini, WID_Wealth_Share_bottom50, WID_Wealth_Share_top10, WID_Wealth_Share_top1)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>WID_dfs_gini <span class="ot">&lt;-</span> <span class="fu">list</span>(WID_Wealth_Gini)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>WID_sublister <span class="ot">&lt;-</span> <span class="cf">function</span>(list, df_name){</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">reduce</span>(list, inner_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>iso3c <span class="ot">&lt;-</span> <span class="fu">countrycode</span>(df<span class="sc">$</span>country, <span class="st">"iso2c"</span>, <span class="st">"iso3c"</span>)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  filtered_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>( <span class="at">Country =</span> iso3c,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>          <span class="at">Year =</span> year) <span class="sc">%&gt;%</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>country)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(df_name, filtered_df, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="fu">WID_sublister</span>(WID_dfs_full, <span class="st">"WID_full"</span>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="fu">WID_sublister</span>(WID_dfs_gini, <span class="st">"WID_gini"</span>)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(WID_Wealth_Share_top1, WID_Wealth_Share_top10, WID_Wealth_Share_bottom50, WID_Wealth_Gini, WID_IncomeDispPost_Share_top1, WID_IncomeDispPost_Share_top10, WID_IncomeDispPost_Share_bottom50, WID_IncomePost_Gini, WID_IncomePre_Gini, list_of_WID_dfs, name, WID_dfs_full, WID_dfs_gini)</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(WID_gini, <span class="st">"data/processed_data/WID_Inequality_gini.csv"</span>)</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(WID_full, <span class="st">"data/processed_data/WID_Inequality_full.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-oecd-tax-revenue-data" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="import-oecd-tax-revenue-data"><span class="header-section-number">3.1.2</span> Import OECD Tax Revenue Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>OECD_TaxRev_Raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"OECD"</span>, <span class="st">"OECD_TaxRev_on_EIG.csv"</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Data_Prep_oecd <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, tax_code, tax_var){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> tax_code){</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter the dataframe and select necessary columns</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    filtered_df <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(GOV <span class="sc">==</span> <span class="st">"NES"</span>, TAX <span class="sc">==</span> i, VAR <span class="sc">==</span> tax_var) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"COU"</span>, <span class="st">"Country"</span>, <span class="st">"Year"</span>, <span class="st">"Value"</span>, <span class="st">"GOV"</span>, <span class="st">"Level of government"</span>, <span class="st">"TAX"</span>, <span class="st">"Tax revenue"</span>, <span class="st">"VAR"</span>, <span class="st">"YEA"</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the unique value from the "Tax revenue" column and prepend "OECD_"</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"OECD_TaxRev_"</span>, <span class="fu">as.character</span>(<span class="fu">substr</span>(<span class="fu">as.character</span>((<span class="fu">unique</span>(filtered_df<span class="sc">$</span><span class="st">"Tax revenue"</span>))), <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">4</span>)))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename the 'Value' column and select necessary columns</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    filtered_df <span class="ot">&lt;-</span> filtered_df <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="sc">!!</span><span class="fu">unique</span>(filtered_df<span class="sc">$</span><span class="st">"Tax revenue"</span>) <span class="sc">:</span><span class="er">=</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"GOV"</span>, <span class="st">"Level of government"</span>, <span class="st">"Tax revenue"</span>, <span class="st">"TAX"</span>, <span class="st">"YEA"</span>, <span class="st">"VAR"</span>))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assign the dataframe to a new variable with the name stored in var_name</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(var_name, filtered_df, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>OECD_TaxRev_Variables <span class="ot">&lt;-</span> (<span class="fu">c</span>(<span class="st">"1000"</span>, <span class="st">"2000"</span>, <span class="st">"3000"</span>, <span class="st">"4000"</span>, <span class="st">"4100"</span>, <span class="st">"4200"</span>, <span class="st">"4300"</span>, <span class="st">"5000"</span>, <span class="st">"6000"</span>))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the function to prepare the data</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">Data_Prep_oecd</span>(OECD_TaxRev_Raw, OECD_TaxRev_Variables, <span class="st">"TAXPER"</span>) <span class="co"># TaxRev of Total TaxRev in Percent</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">Data_Prep_oecd</span>(OECD_TaxRev_Raw, <span class="st">"TOTALTAX"</span>, <span class="st">"TAXGDP"</span>) <span class="co"># Total TaxRev of GDP in Percent</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Join all the dataframes</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>list_of_OECD_dfs <span class="ot">&lt;-</span> <span class="fu">list</span>(OECD_TaxRev_1000, OECD_TaxRev_2000, OECD_TaxRev_3000, OECD_TaxRev_4000, OECD_TaxRev_4100, OECD_TaxRev_4200, OECD_TaxRev_4300, OECD_TaxRev_5000, OECD_TaxRev_6000, OECD_TaxRev_Tota)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>OECD_TaxRev <span class="ot">&lt;-</span> <span class="fu">reduce</span>(list_of_OECD_dfs, inner_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>, <span class="st">"COU"</span>))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>OECD_TaxRev <span class="ot">&lt;-</span> OECD_TaxRev <span class="sc">%&gt;%</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>( <span class="st">"Country_Name"</span> <span class="ot">=</span> <span class="st">"Country"</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Country"</span> <span class="ot">=</span> <span class="st">"COU"</span>,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_Income_IPC_1000"</span> <span class="ot">=</span> <span class="st">"1000 Taxes on income, profits and capital gains"</span>,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_Social_SSC_2000"</span> <span class="ot">=</span> <span class="st">"2000 Social security contributions (SSC)"</span>,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_Payroll_PW_3000"</span> <span class="ot">=</span> <span class="st">"3000 Taxes on payroll and workforce"</span>,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_Property_4000"</span> <span class="ot">=</span> <span class="st">"4000 Taxes on property"</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_ImmovProp_4100"</span> <span class="ot">=</span> <span class="st">"4100 Recurrent taxes on immovable property"</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_NetWealth_4200"</span> <span class="ot">=</span> <span class="st">"4200 Recurrent taxes on net wealth"</span>,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_EIG_4300"</span> <span class="ot">=</span> <span class="st">"4300 Estate, inheritance and gift taxes"</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_GoodsServices_5000"</span> <span class="ot">=</span> <span class="st">"5000 Taxes on goods and services"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_Others_6000"</span> <span class="ot">=</span> <span class="st">"6000 Taxes other than 1000, 2000, 3000, 4000 and 5000"</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>          <span class="st">"TaxRev_TotalofGDP"</span> <span class="ot">=</span> <span class="st">"Total tax revenue"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(OECD_TaxRev_1000, OECD_TaxRev_2000, OECD_TaxRev_3000, OECD_TaxRev_4000, OECD_TaxRev_4100, OECD_TaxRev_4200, OECD_TaxRev_4300, OECD_TaxRev_5000, OECD_TaxRev_6000, list_of_OECD_dfs, OECD_TaxRev_Raw, OECD_TaxRev_Variables, OECD_TaxRev_Tota)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(OECD_TaxRev, <span class="st">"data/processed_data/OECD_TaxRev.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-world-bank-indicators" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="import-world-bank-indicators"><span class="header-section-number">3.1.3</span> Import World Bank Indicators</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>WB_Unemployment <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"World Bank"</span>,<span class="st">"WB_Unemployment.csv"</span>), <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>WB_Unemployment <span class="ot">&lt;-</span> WB_Unemployment <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Country Name"</span>, <span class="st">"Country Code"</span>, <span class="st">"Indicator Name"</span>, <span class="st">"Indicator Code"</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Anzahl"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Country =</span> <span class="st">"Country Code"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Unemployment_rate =</span> <span class="st">"Anzahl"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.double</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, Unemployment_rate)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>WB_GDP_constant <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"World Bank"</span>,<span class="st">"WB_GDP_ConstantUSD.csv"</span>), <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>WB_GDP_constant_long <span class="ot">&lt;-</span> WB_GDP_constant <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Country Name"</span>, <span class="st">"Country Code"</span>, <span class="st">"Indicator Name"</span>, <span class="st">"Indicator Code"</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Anzahl"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Country =</span> <span class="st">"Country Code"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">GDP_constant =</span> <span class="st">"Anzahl"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.double</span>(Year),  </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">GDP_constant_billions =</span> GDP_constant <span class="sc">/</span> <span class="fl">1e9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, GDP_constant_billions)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>WB_GDP_current <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"World Bank"</span>,<span class="st">"WB_GDP_CurrentUSD.csv"</span>), <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>WB_GDP_current_long <span class="ot">&lt;-</span> WB_GDP_current <span class="sc">%&gt;%</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Country Name"</span>, <span class="st">"Country Code"</span>, <span class="st">"Indicator Name"</span>, <span class="st">"Indicator Code"</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Anzahl"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Country =</span> <span class="st">"Country Code"</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">GDP_current =</span> <span class="st">"Anzahl"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.double</span>(Year),  </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">GDP_current_billions =</span> GDP_current <span class="sc">/</span> <span class="fl">1e9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, GDP_current_billions)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>WB_GDP_long <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(WB_GDP_constant_long, WB_GDP_current_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>WB <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(WB_Unemployment, WB_GDP_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(WB_GDP_constant, WB_GDP_constant_long, WB_GDP_current, WB_GDP_current_long, WB_Unemployment, WB_GDP_long)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(WB, <span class="st">"data/processed_data/WB_Indicators.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-gc-tax-dataset" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="import-gc-tax-dataset"><span class="header-section-number">3.1.4</span> Import GC Tax Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>GC_EIGTopRate <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"GC Tax"</span>, <span class="st">"GC_TopMarginalEIGRates.csv"</span>), <span class="at">delim =</span> <span class="st">";"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace comma with dot and convert string to numeric</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>GC_EIGTopRate<span class="sc">$</span>Value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, GC_EIGTopRate<span class="sc">$</span>Value))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert ISO 2-letter codes to ISO 3-letter codes</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>GC_EIGTopRate<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">countrycode</span>(GC_EIGTopRate<span class="sc">$</span>Country1, <span class="st">"country.name"</span>, <span class="st">"iso3c"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the unique value from the "Tax revenue" column and prepend "OECD_"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"GC_"</span>, <span class="fu">as.character</span>(<span class="fu">as.character</span>((<span class="fu">unique</span>(GC_EIGTopRate<span class="sc">$</span><span class="st">"Threshold vs Marginal (Thresholds)"</span>)))))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>GC_EIGTopRate <span class="ot">&lt;-</span> GC_EIGTopRate <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Country, Year, Value) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename_with</span>(<span class="sc">~</span> var_name, <span class="at">.cols =</span> <span class="st">"Value"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(var_name)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(GC_EIGTopRate, <span class="st">"data/processed_data/GC_EIGTopRate.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-vdem-data" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="import-vdem-data"><span class="header-section-number">3.1.5</span> Import VDEM Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, you need to have the devtools package installed</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># now, install the vdemdata package directly from GitHub</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("vdeminstitute/vdemdata")</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>VDEM <span class="ot">&lt;-</span> vdem <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(country_text_id, year, v2peedueq, v2x_corr, v2x_libdem)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>( <span class="st">"Country"</span> <span class="ot">=</span> <span class="st">"country_text_id"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Year"</span> <span class="ot">=</span> <span class="st">"year"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(VDEM, <span class="st">"data/processed_data/VDEM.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-welfare-regimes" class="level3" data-number="3.1.6">
<h3 data-number="3.1.6" class="anchored" data-anchor-id="import-welfare-regimes"><span class="header-section-number">3.1.6</span> Import Welfare Regimes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Regime <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Welfare_Regimes"</span>,<span class="st">"welfare_regimes_Main.csv"</span>), <span class="at">delim =</span> <span class="st">";"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert ISO 2-letter codes to ISO 3-letter codes</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Regime<span class="sc">$</span>Country_Code_2 <span class="ot">&lt;-</span> <span class="fu">countrycode</span>(Regime<span class="sc">$</span>Country_Name, <span class="st">"country.name"</span>, <span class="st">"iso3c"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Regime <span class="ot">&lt;-</span> Regime <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>( <span class="st">"Country"</span> <span class="ot">=</span> <span class="st">"Country_Code_2"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Country_Name"</span> <span class="ot">=</span> <span class="st">"Country_Name"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"welfare_regime"</span> <span class="ot">=</span> <span class="st">"welfare_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, welfare_regime)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Regime, <span class="st">"data/processed_data/Welfare_Regimes.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="merge-datasets" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="merge-datasets"><span class="header-section-number">3.2</span> Merge Datasets</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join all the dataframes</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dfs_all <span class="ot">&lt;-</span> <span class="fu">list</span>(OECD_TaxRev, WID_full, VDEM, WB)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>tax_all <span class="ot">&lt;-</span> <span class="fu">reduce</span>(dfs_all, inner_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>dfs_minimal <span class="ot">&lt;-</span> <span class="fu">list</span>(OECD_TaxRev, WID_gini, VDEM, WB)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>tax_minimal <span class="ot">&lt;-</span> <span class="fu">reduce</span>(dfs_minimal, inner_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime <span class="ot">&lt;-</span> <span class="fu">merge</span>(tax_minimal, Regime, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>tax_all_regime <span class="ot">&lt;-</span> <span class="fu">merge</span>(tax_all, Regime, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(WID_full, WID_gini, OECD_TaxRev, VDEM, WB, dfs_all, dfs_minimal, GC_EIGTopRate)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(tax_minimal, <span class="st">"data/processed_data/tax_minimal.csv"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(tax_all, <span class="st">"data/processed_data/tax_all.csv"</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(tax_minimal_regime, <span class="st">"data/processed_data/tax_minimal_regime.csv"</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(tax_all_regime, <span class="st">"data/processed_data/tax_all_regime.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="perfom-multiple-imputation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="perfom-multiple-imputation"><span class="header-section-number">3.3</span> Perfom Multiple Imputation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation for tax_minimal_regime -dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"tax_minimal_regime.csv"</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp0 <span class="ot">&lt;-</span> tax_minimal_regime <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Country_Name, <span class="sc">-</span>welfare_regime)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp0 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tax_minimal_regime_imp0)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp <span class="ot">&lt;-</span> <span class="fu">amelia</span>(tax_minimal_regime_imp0, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">ts =</span> <span class="st">"Year"</span>, <span class="at">cs =</span> <span class="st">"Country"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp_data_1 <span class="ot">&lt;-</span> tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp1</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp_data_2 <span class="ot">&lt;-</span> tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp2</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp_data_3 <span class="ot">&lt;-</span> tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp3</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp_data_4 <span class="ot">&lt;-</span> tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp4</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp_data_5 <span class="ot">&lt;-</span> tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp5</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(tax_minimal_regime<span class="sc">$</span>Unemployment_rate, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp1<span class="sc">$</span>Unemployment_rate), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp2<span class="sc">$</span>Unemployment_rate), <span class="at">col=</span><span class="st">"green"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp3<span class="sc">$</span>Unemployment_rate), <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp4<span class="sc">$</span>Unemployment_rate), <span class="at">col=</span><span class="st">"orange"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp4<span class="sc">$</span>Unemployment_rate), <span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(tax_minimal_regime<span class="sc">$</span>GDP_constant_billions, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp1<span class="sc">$</span>GDP_constant_billions), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp2<span class="sc">$</span>GDP_constant_billions), <span class="at">col=</span><span class="st">"green"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp3<span class="sc">$</span>GDP_constant_billions), <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp4<span class="sc">$</span>GDP_constant_billions), <span class="at">col=</span><span class="st">"orange"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(tax_minimal_regime_imp<span class="sc">$</span>imputations<span class="sc">$</span>imp4<span class="sc">$</span>GDP_constant_billions), <span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose imputed dataset</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp <span class="ot">&lt;-</span> tax_minimal_regime_imp_data_2</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>Regime <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"Welfare_Regimes.csv"</span>))</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp <span class="ot">&lt;-</span> <span class="fu">merge</span>(tax_minimal_regune_imp, Regime, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span>))</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tax_minimal_regime_imp0, tax_minimal_regime_imp_data_1, tax_minimal_regime_imp_data_2, tax_minimal_regime_imp_data_3, tax_minimal_regime_imp_data_4, tax_minimal_regime_imp_data_5, Regime, tax_minimal_regime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="removing-outliers" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="removing-outliers"><span class="header-section-number">3.4</span> Removing Outliers</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outliers</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming df is your data frame, group_var is your grouping variable, and var is your variable</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>zero_groups <span class="ot">&lt;-</span> tax_minimal_regime_imp <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_var =</span> <span class="fu">sum</span>(TaxRev_EIG_4300, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sum_var <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>zero_groups</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>tax_minimal_regime_imp_reduced <span class="ot">&lt;-</span> tax_minimal_regime_imp <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">!=</span> <span class="st">"AUS"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>         Country <span class="sc">!=</span> <span class="st">"EST"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>         Country <span class="sc">!=</span> <span class="st">"NZL"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tax_minimal_regime_imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="balancing-the-datasets" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="balancing-the-datasets"><span class="header-section-number">3.5</span> Balancing the datasets</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> tax_minimal_regime_imp_reduced <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1995</span>, Year <span class="sc">&lt;=</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">26</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tax_minimal_regime_imp_reduced)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(equaltax, <span class="st">"data/processed_data/equaltax_balanced.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="desciptive-statistics" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Desciptive Statistics</h1>
<section id="summary-stats-of-the-equaltax-dataset" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="summary-stats-of-the-equaltax-dataset"><span class="header-section-number">4.1</span> Summary Stats of the Equaltax Dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the tax_minimal dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">sumtable</span>(equaltax,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">vars=</span><span class="fu">c</span>(<span class="st">'Country'</span>, <span class="st">'Year'</span>, <span class="st">'TaxRev_Income_IPC_1000'</span>, <span class="st">'TaxRev_EIG_4300'</span>, <span class="st">'TaxRev_ImmovProp_4100'</span>, <span class="st">'TaxRev_NetWealth_4200'</span>, <span class="st">'TaxRev_TotalofGDP'</span>, <span class="st">'v2x_libdem'</span>, <span class="st">'v2peedueq'</span>, <span class="st">'Unemployment_rate'</span>, <span class="st">'GDP_constant_billions'</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">summ=</span><span class="fu">c</span>(<span class="st">'notNA(x)'</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mean(x)'</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'median(x)'</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd(x)'</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'min(x)'</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pctile(x)[25]'</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pctile(x)[75]'</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'max(x)'</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                <span class="co"># out = 'latex',</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                <span class="co"># file = "latex/tables/table1.tex"</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sumtable(equaltax, vars = c("Country", "Year",
"TaxRev_Income_IPC_1000", : You have specified a variable in vars that is a
character variable with a large number of different values. It will be
excluded. If you are sure you want it in the table, convert it to a factor
before calling sumtable.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">NotNA</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Median</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sd</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctile[25]</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctile[75]</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Year</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">2008</td>
<td style="text-align: left;">2008</td>
<td style="text-align: left;">7.8</td>
<td style="text-align: left;">1995</td>
<td style="text-align: left;">2001</td>
<td style="text-align: left;">2015</td>
<td style="text-align: left;">2021</td>
</tr>
<tr class="even">
<td style="text-align: left;">TaxRev_Income_IPC_1000</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">34</td>
<td style="text-align: left;">32</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">26</td>
<td style="text-align: left;">40</td>
<td style="text-align: left;">66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TaxRev_EIG_4300</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">0.46</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.072</td>
<td style="text-align: left;">0.71</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">TaxRev_ImmovProp_4100</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">3.2</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.26</td>
<td style="text-align: left;">1.1</td>
<td style="text-align: left;">3.7</td>
<td style="text-align: left;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TaxRev_NetWealth_4200</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">0.45</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">-0.003</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.49</td>
<td style="text-align: left;">5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TaxRev_TotalofGDP</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">36</td>
<td style="text-align: left;">35</td>
<td style="text-align: left;">6.4</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">42</td>
<td style="text-align: left;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">v2x_libdem</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">0.071</td>
<td style="text-align: left;">0.35</td>
<td style="text-align: left;">0.77</td>
<td style="text-align: left;">0.84</td>
<td style="text-align: left;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">v2peedueq</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">2.4</td>
<td style="text-align: left;">2.4</td>
<td style="text-align: left;">0.66</td>
<td style="text-align: left;">0.74</td>
<td style="text-align: left;">2.2</td>
<td style="text-align: left;">2.8</td>
<td style="text-align: left;">3.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unemployment_rate</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">7.9</td>
<td style="text-align: left;">7.1</td>
<td style="text-align: left;">4.3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">4.8</td>
<td style="text-align: left;">9.5</td>
<td style="text-align: left;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_constant_billions</td>
<td style="text-align: left;">621</td>
<td style="text-align: left;">1618</td>
<td style="text-align: left;">428</td>
<td style="text-align: left;">3306</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">222</td>
<td style="text-align: left;">1775</td>
<td style="text-align: left;">20529</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="graphical-setup" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="graphical-setup"><span class="header-section-number">4.2</span> Graphical Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mein_theme <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>( <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Roboto"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Roboto"</span>, <span class="at">face=</span><span class="st">"plain"</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Roboto"</span>, <span class="at">face=</span><span class="st">"plain"</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Roboto"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Roboto"</span>, <span class="at">face=</span><span class="st">"plain"</span>, <span class="at">size=</span><span class="dv">12</span>)) </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>palette1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#fd7f6f"</span>, <span class="st">"#7eb0d5"</span>, <span class="st">"#b2e061"</span>, <span class="st">"#bd7ebe"</span>, <span class="st">"#ffb55a"</span>, <span class="st">"#ffee65"</span>, <span class="st">"#beb9db"</span>, <span class="st">"#fdcce5"</span>, <span class="st">"#8bd3c7"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>nb.cols <span class="ot">&lt;-</span> <span class="dv">23</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(palette1)(nb.cols)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>(<span class="at">Merriweather=</span><span class="fu">windowsFont</span>(<span class="st">"Roboto"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="descriptive-graphs" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="descriptive-graphs"><span class="header-section-number">4.3</span> Descriptive Graphs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 1 - Vermögensungleichheit über die Zeit</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>equaltax <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y=</span>Wealth_Gini)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Country) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#69b3a2"</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Wealth Gini Index"</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mein_theme</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HA_Justice_Prep_portfolio_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2 - EIG Tax Revenue über die Zeit</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>equaltax <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y=</span>TaxRev_EIG_4300)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Country) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#69b3a2"</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"EIG Tax Revenue (%-Anteil an gesamten Tax Revenue)"</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mein_theme</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HA_Justice_Prep_portfolio_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 3 - EIG Tax Revenue und Vermögensungleichheit</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot of the Wealth Gini and TaxRev_EIG_4300</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fe.dummy<span class="ot">&lt;-</span><span class="fu">lm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate <span class="sc">+</span> <span class="fu">factor</span>(Country)<span class="sc">-</span><span class="dv">1</span>, <span class="at">data=</span>equaltax) </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe.dummy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Wealth_Gini ~ TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq + GDP_constant_billions + Unemployment_rate + 
    factor(Country) - 1, data = equaltax)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.083859 -0.009026  0.000190  0.010150  0.063427 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
TaxRev_Income_IPC_1000  1.085e-04  3.659e-04   0.296  0.76699    
TaxRev_EIG_4300        -1.478e-02  5.593e-03  -2.643  0.00845 ** 
TaxRev_ImmovProp_4100   1.471e-02  1.400e-03  10.507  &lt; 2e-16 ***
TaxRev_NetWealth_4200  -7.834e-03  3.608e-03  -2.172  0.03028 *  
TaxRev_TotalofGDP       2.034e-03  4.326e-04   4.702 3.21e-06 ***
v2x_libdem             -8.873e-02  1.806e-02  -4.914 1.16e-06 ***
v2peedueq               1.033e-02  3.256e-03   3.173  0.00159 ** 
GDP_constant_billions   4.850e-07  1.459e-06   0.332  0.73974    
Unemployment_rate       7.189e-04  3.287e-04   2.188  0.02909 *  
factor(Country)AUT      7.380e-01  2.333e-02  31.627  &lt; 2e-16 ***
factor(Country)BEL      6.022e-01  2.690e-02  22.384  &lt; 2e-16 ***
factor(Country)CAN      5.701e-01  2.748e-02  20.747  &lt; 2e-16 ***
factor(Country)CHE      7.595e-01  2.909e-02  26.111  &lt; 2e-16 ***
factor(Country)CZE      6.891e-01  2.097e-02  32.866  &lt; 2e-16 ***
factor(Country)DEU      7.006e-01  2.366e-02  29.617  &lt; 2e-16 ***
factor(Country)DNK      6.244e-01  3.049e-02  20.477  &lt; 2e-16 ***
factor(Country)ESP      6.336e-01  2.219e-02  28.559  &lt; 2e-16 ***
factor(Country)FIN      6.768e-01  2.587e-02  26.165  &lt; 2e-16 ***
factor(Country)FRA      6.069e-01  2.665e-02  22.778  &lt; 2e-16 ***
factor(Country)GBR      5.699e-01  2.615e-02  21.798  &lt; 2e-16 ***
factor(Country)GRC      7.020e-01  2.206e-02  31.819  &lt; 2e-16 ***
factor(Country)HUN      7.069e-01  2.010e-02  35.164  &lt; 2e-16 ***
factor(Country)IRL      8.384e-01  2.232e-02  37.566  &lt; 2e-16 ***
factor(Country)ITA      6.348e-01  2.391e-02  26.553  &lt; 2e-16 ***
factor(Country)JPN      6.179e-01  2.640e-02  23.401  &lt; 2e-16 ***
factor(Country)LVA      7.136e-01  1.899e-02  37.586  &lt; 2e-16 ***
factor(Country)NLD      6.259e-01  2.323e-02  26.942  &lt; 2e-16 ***
factor(Country)NOR      6.825e-01  2.653e-02  25.723  &lt; 2e-16 ***
factor(Country)POL      7.571e-01  2.098e-02  36.084  &lt; 2e-16 ***
factor(Country)PRT      7.027e-01  2.112e-02  33.276  &lt; 2e-16 ***
factor(Country)SWE      6.700e-01  2.605e-02  25.721  &lt; 2e-16 ***
factor(Country)USA      6.689e-01  3.526e-02  18.971  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01826 on 589 degrees of freedom
Multiple R-squared:  0.9994,    Adjusted R-squared:  0.9994 
F-statistic: 3.261e+04 on 32 and 589 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with the predicted values and the original data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"yhat"</span> <span class="ot">=</span> fe.dummy<span class="sc">$</span>fitted, equaltax)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> TaxRev_EIG_4300, <span class="at">y =</span> yhat, <span class="at">colour =</span> Country)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"EIG TAX"</span>, <span class="at">y =</span> <span class="st">"predicted Wealth Inequality"</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> mycolors) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"EIG-Tax Revenue (%-Anteil an gesamten Tax Revenue)"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wealth Gini-Koeffizient"</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">"Land"</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mein_theme</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HA_Justice_Prep_portfolio_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="regression-models" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Regression Models</h1>
<section id="deciding-for-a-specific-model" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="deciding-for-a-specific-model"><span class="header-section-number">5.1</span> Deciding for a specific model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate a fixed effects model</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> Unemployment_rate <span class="sc">+</span> GDP_constant_billions, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq + Unemployment_rate + GDP_constant_billions, 
    data = equaltax, effect = "individual", model = "within", 
    index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.0838587 -0.0090261  0.0001897  0.0101500  0.0634268 

Coefficients:
                          Estimate  Std. Error t-value  Pr(&gt;|t|)    
TaxRev_Income_IPC_1000  1.0848e-04  3.6592e-04  0.2964  0.766994    
TaxRev_EIG_4300        -1.4781e-02  5.5934e-03 -2.6425  0.008448 ** 
TaxRev_ImmovProp_4100   1.4714e-02  1.4004e-03 10.5070 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -7.8344e-03  3.6076e-03 -2.1716  0.030282 *  
TaxRev_TotalofGDP       2.0343e-03  4.3264e-04  4.7020 3.212e-06 ***
v2x_libdem             -8.8734e-02  1.8057e-02 -4.9140 1.158e-06 ***
v2peedueq               1.0331e-02  3.2562e-03  3.1727  0.001589 ** 
Unemployment_rate       7.1895e-04  3.2865e-04  2.1876  0.029094 *  
GDP_constant_billions   4.8499e-07  1.4593e-06  0.3324  0.739738    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.29474
Residual Sum of Squares: 0.1964
R-Squared:      0.33365
Adj. R-Squared: 0.29858
F-statistic: 32.7691 on 9 and 589 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute panel-corrected standard errors</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model_fe, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model_fe, <span class="at">type =</span> <span class="st">"HC3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                          Estimate  Std. Error t value Pr(&gt;|t|)   
TaxRev_Income_IPC_1000  1.0848e-04  9.5537e-04  0.1135 0.909638   
TaxRev_EIG_4300        -1.4781e-02  1.1890e-02 -1.2431 0.214330   
TaxRev_ImmovProp_4100   1.4714e-02  4.9737e-03  2.9585 0.003216 **
TaxRev_NetWealth_4200  -7.8344e-03  9.4496e-03 -0.8291 0.407398   
TaxRev_TotalofGDP       2.0343e-03  1.5271e-03  1.3321 0.183340   
v2x_libdem             -8.8734e-02  3.9651e-02 -2.2379 0.025601 * 
v2peedueq               1.0331e-02  1.1726e-02  0.8810 0.378684   
Unemployment_rate       7.1895e-04  6.8563e-04  1.0486 0.294796   
GDP_constant_billions   4.8499e-07  1.6215e-06  0.2991 0.764969   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate a random effects model</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>model_re <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> Unemployment_rate <span class="sc">+</span> GDP_constant_billions, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax,  <span class="at">model =</span> <span class="st">"random"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_re)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = Wealth_Gini ~ TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq + Unemployment_rate + GDP_constant_billions, 
    data = equaltax, effect = "individual", model = "random", 
    index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Effects:
                    var   std.dev share
idiosyncratic 0.0003334 0.0182604  0.12
individual    0.0024532 0.0495300  0.88
theta: 0.9292

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.0890705 -0.0091921 -0.0001370  0.0101062  0.0586815 

Coefficients:
                          Estimate  Std. Error z-value  Pr(&gt;|z|)    
(Intercept)             6.9025e-01  2.5008e-02 27.6008 &lt; 2.2e-16 ***
TaxRev_Income_IPC_1000  1.4308e-05  3.4818e-04  0.0411  0.967221    
TaxRev_EIG_4300        -1.7407e-02  5.4485e-03 -3.1949  0.001399 ** 
TaxRev_ImmovProp_4100   1.3386e-02  1.3344e-03 10.0313 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -6.1579e-03  3.4518e-03 -1.7840  0.074431 .  
TaxRev_TotalofGDP       1.8623e-03  4.2085e-04  4.4251 9.641e-06 ***
v2x_libdem             -8.8640e-02  1.8187e-02 -4.8738 1.095e-06 ***
v2peedueq               9.1129e-03  3.2403e-03  2.8124  0.004917 ** 
Unemployment_rate       8.1760e-04  3.2833e-04  2.4901  0.012769 *  
GDP_constant_billions   1.2939e-07  1.3680e-06  0.0946  0.924642    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.30215
Residual Sum of Squares: 0.20828
R-Squared:      0.31067
Adj. R-Squared: 0.30052
Chisq: 275.372 on 9 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute panel-corrected standard errors</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model_re, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model_re, <span class="at">type =</span> <span class="st">"HC3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                          Estimate  Std. Error t value  Pr(&gt;|t|)    
(Intercept)             6.9025e-01  5.9194e-02 11.6609 &lt; 2.2e-16 ***
TaxRev_Income_IPC_1000  1.4308e-05  9.1510e-04  0.0156  0.987530    
TaxRev_EIG_4300        -1.7407e-02  1.0873e-02 -1.6010  0.109891    
TaxRev_ImmovProp_4100   1.3386e-02  4.9609e-03  2.6982  0.007164 ** 
TaxRev_NetWealth_4200  -6.1579e-03  8.7285e-03 -0.7055  0.480775    
TaxRev_TotalofGDP       1.8623e-03  1.5267e-03  1.2198  0.223018    
v2x_libdem             -8.8640e-02  3.9733e-02 -2.2309  0.026050 *  
v2peedueq               9.1129e-03  1.1074e-02  0.8229  0.410896    
Unemployment_rate       8.1760e-04  7.0020e-04  1.1677  0.243398    
GDP_constant_billions   1.2939e-07  1.7142e-06  0.0755  0.939856    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a Hausman test</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">phtest</span>(model_fe, model_re) <span class="co"># fe Model wins </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hausman Test

data:  Wealth_Gini ~ TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + TaxRev_ImmovProp_4100 +  ...
chisq = 156.3, df = 9, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Against Beck-Katz</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>model_beckkatz <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> <span class="fu">lag</span>(Wealth_Gini, <span class="dv">1</span>) <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> Unemployment_rate <span class="sc">+</span> GDP_constant_billions, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"pooling"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index=</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_beckkatz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pooling Model

Call:
plm(formula = Wealth_Gini ~ lag(Wealth_Gini, 1) + TaxRev_Income_IPC_1000 + 
    TaxRev_EIG_4300 + TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + 
    TaxRev_TotalofGDP + v2x_libdem + v2peedueq + Unemployment_rate + 
    GDP_constant_billions, data = equaltax, effect = "individual", 
    model = "pooling", index = c("Country", "Year"))

Balanced Panel: n = 23, T = 26, N = 598

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-2.9632e-02 -2.3976e-03 -1.2579e-05  2.0952e-03  5.2221e-02 

Coefficients:
                          Estimate  Std. Error  t-value  Pr(&gt;|t|)    
(Intercept)             1.2322e-02  7.3652e-03   1.6731  0.094846 .  
lag(Wealth_Gini, 1)     9.8532e-01  6.6501e-03 148.1673 &lt; 2.2e-16 ***
TaxRev_Income_IPC_1000  4.5256e-07  3.9754e-05   0.0114  0.990921    
TaxRev_EIG_4300        -1.6096e-03  8.8042e-04  -1.8282  0.068024 .  
TaxRev_ImmovProp_4100   7.7806e-05  1.5864e-04   0.4905  0.623991    
TaxRev_NetWealth_4200   1.0182e-03  3.6252e-04   2.8085  0.005143 ** 
TaxRev_TotalofGDP       6.0089e-05  6.0188e-05   0.9984  0.318517    
v2x_libdem             -8.6105e-03  5.1731e-03  -1.6645  0.096548 .  
v2peedueq               3.1109e-04  6.2646e-04   0.4966  0.619673    
Unemployment_rate       3.5491e-04  7.8213e-05   4.5377   6.9e-06 ***
GDP_constant_billions   2.7187e-07  1.3961e-07   1.9474  0.051964 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    1.7082
Residual Sum of Squares: 0.030309
R-Squared:      0.98226
Adj. R-Squared: 0.98195
F-statistic: 3249.63 on 10 and 587 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  beck-katz approach leads to way to low standard errors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-thoughts-of-the-modelling-decision" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="summary-thoughts-of-the-modelling-decision"><span class="header-section-number">5.2</span> Summary Thoughts of the Modelling Decision</h2>
<p>Based on the updated comments, here is a revised conclusion:</p>
<p>The Beck-Katz approach was found to significantly underestimate standard errors, especially in the context of unbalanced panel data, and is therefore not recommended for this analysis.</p>
<p>Instead, an Ordinary Least Squares (OLS) regression model with Fixed Effects (FE) and a Lagged Dependent Variable should be used. To address the issue of heteroskedasticity, Panel-Corrected Standard Errors (PCSEs) should be calculated post-estimation.</p>
<p>In the process of data preparation, countries with a very low number of observations or those that have no data after 1980 should be excluded from the analysis to avoid potential bias or inaccuracies.</p>
<p>Furthermore, the assumptions of the random effects model do not align with the expectations of the research question. This misalignment is reflected in the coefficients of the random effects model, which, when compared to the coefficients of the fixed effects model, do not make sense as they partially point in the wrong direction.</p>
<p>Finally, to ensure the validity and reliability of the model, other diagnostic tests should be performed. These could include tests for multicollinearity, serial correlation, and stationarity, among others. These additional checks will help to confirm the appropriateness of the chosen model and the robustness of the findings.</p>
</section>
<section id="se-correction-tests" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="se-correction-tests"><span class="header-section-number">5.3</span> SE Correction Tests</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>bgtestASE <span class="ot">&lt;-</span> <span class="cf">function</span>(model){</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute vcovHC standard errors</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  se_hc <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">"HC3"</span>)))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust residuals</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  resid_adj <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model) <span class="sc">/</span> se_hc</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Breusch-Godfrey test on adjusted residuals</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bgtest</span>(resid_adj <span class="sc">~</span> <span class="fu">fitted.values</span>(model), <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>bgtestPCSE <span class="ot">&lt;-</span> <span class="cf">function</span>(model){</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute vcovBK standard errors</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  se_hc <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovBK</span>(model, <span class="at">cluster =</span> <span class="st">"time"</span>)))</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust residuals</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  resid_adj <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model) <span class="sc">/</span> se_hc</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Breusch-Godfrey test on adjusted residuals</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bgtest</span>(resid_adj <span class="sc">~</span> <span class="fu">fitted.values</span>(model), <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>bgtestDKSE <span class="ot">&lt;-</span> <span class="cf">function</span>(model){</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute vcovSCC standard errors</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  se_hc <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovSCC</span>(model, <span class="at">cluster =</span> <span class="st">"time"</span>)))</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust residuals</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  resid_adj <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model) <span class="sc">/</span> se_hc</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Breusch-Godfrey test on adjusted residuals</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bgtest</span>(resid_adj <span class="sc">~</span> <span class="fu">fitted.values</span>(model), <span class="at">order =</span> <span class="dv">1</span>)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="arellano-standard-errors-ase-fe-models" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="arellano-standard-errors-ase-fe-models"><span class="header-section-number">5.3.1</span> Arellano standard errors (ASE)-FE-Models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Standard Model</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test ohne Korrektur</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pbgtest</span>(model_fe) <span class="co"># Autokorrelation vorhanden</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey/Wooldridge test for serial correlation in panel models

data:  Wealth_Gini ~ TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + TaxRev_ImmovProp_4100 +  ...
chisq = 415.02, df = 27, p-value &lt; 2.2e-16
alternative hypothesis: serial correlation in idiosyncratic errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test mit ASE-Korrektur</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtestASE</span>(model_fe) <span class="co"># Korrektur hilft gegen Autokorrelation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 1

data:  resid_adj ~ fitted.values(model)
LM test = 0.014789, df = 1, p-value = 0.9032</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Model with ASE Correction</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>model_feASE <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model_fe, <span class="at">type =</span> <span class="st">"HC3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="panel-corrected-standard-errors-pcse-fe-models" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="panel-corrected-standard-errors-pcse-fe-models"><span class="header-section-number">5.3.2</span> Panel corrected standard errors (PCSE)-FE-Models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Standard Model</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test ohne Korrektur</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pbgtest</span>(model_fe) <span class="co"># Autokorrelation vorhanden</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey/Wooldridge test for serial correlation in panel models

data:  Wealth_Gini ~ +TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + TaxRev_ImmovProp_4100 +  ...
chisq = 415.02, df = 27, p-value &lt; 2.2e-16
alternative hypothesis: serial correlation in idiosyncratic errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test mit PCSE-Korrektur</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtestDKSE</span>(model_fe) <span class="co"># Korrektur hilft gegen Autokorrelation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 1

data:  resid_adj ~ fitted.values(model)
LM test = 0.02122, df = 1, p-value = 0.8842</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Model with PCSE Correction</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>model_fePCSE <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe, <span class="at">cluster =</span> <span class="st">"time"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="driscoll-and-kraay-standard-errors-dkse-fe-models" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="driscoll-and-kraay-standard-errors-dkse-fe-models"><span class="header-section-number">5.3.3</span> Driscoll and Kraay standard errors (DKSE)-FE-Models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Standard Model</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test ohne Korrektur</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pbgtest</span>(model_fe) <span class="co"># Autokorrelation vorhanden</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey/Wooldridge test for serial correlation in panel models

data:  Wealth_Gini ~ TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + TaxRev_ImmovProp_4100 +  ...
chisq = 415.02, df = 27, p-value &lt; 2.2e-16
alternative hypothesis: serial correlation in idiosyncratic errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test mit ASE-Korrektur</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtestASE</span>(model_fe) <span class="co"># Korrektur hilft gegen Autokorrelation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 1

data:  resid_adj ~ fitted.values(model)
LM test = 0.014789, df = 1, p-value = 0.9032</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Model with ASE Correction</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>model_feDKSE <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe, <span class="at">vcov=</span><span class="fu">vcovSCC</span>(model_fe, <span class="at">cluster =</span> <span class="st">"time"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lagged-dependent-variable-model" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="lagged-dependent-variable-model"><span class="header-section-number">5.3.4</span> Lagged Dependent Variable Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - Extended-Control Model Plus</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>model_fe_lag <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> <span class="fu">lag</span>(Wealth_Gini, <span class="dv">1</span>) <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate, </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_lag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ lag(Wealth_Gini, 1) + TaxRev_Income_IPC_1000 + 
    TaxRev_EIG_4300 + TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + 
    TaxRev_TotalofGDP + v2x_libdem + v2peedueq + GDP_constant_billions + 
    Unemployment_rate, data = equaltax, effect = "individual", 
    model = "within", index = c("Country", "Year"))

Balanced Panel: n = 23, T = 26, N = 598

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-0.02803456 -0.00253003  0.00013528  0.00229288  0.04709432 

Coefficients:
                          Estimate  Std. Error t-value  Pr(&gt;|t|)    
lag(Wealth_Gini, 1)     9.0531e-01  1.5847e-02 57.1286 &lt; 2.2e-16 ***
TaxRev_Income_IPC_1000 -2.9806e-05  1.4579e-04 -0.2044  0.838084    
TaxRev_EIG_4300        -4.0605e-03  2.2733e-03 -1.7862  0.074603 .  
TaxRev_ImmovProp_4100   7.9362e-04  5.9663e-04  1.3302  0.183999    
TaxRev_NetWealth_4200   2.2392e-03  1.4432e-03  1.5515  0.121330    
TaxRev_TotalofGDP       1.3691e-04  1.7135e-04  0.7990  0.424599    
v2x_libdem             -1.8737e-02  7.0223e-03 -2.6682  0.007844 ** 
v2peedueq               5.4543e-04  1.2659e-03  0.4309  0.666721    
GDP_constant_billions  -7.5161e-07  5.9810e-07 -1.2567  0.209394    
Unemployment_rate       5.1856e-04  1.2868e-04  4.0297  6.35e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.27456
Residual Sum of Squares: 0.026798
R-Squared:      0.9024
Adj. R-Squared: 0.89687
F-statistic: 522.386 on 10 and 565 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Standard Model</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test ohne Korrektur</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pbgtest</span>(model_fe_lag) <span class="co"># Autokorrelation vorhanden trotz LDV</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey/Wooldridge test for serial correlation in panel models

data:  Wealth_Gini ~ lag(Wealth_Gini, 1) + TaxRev_Income_IPC_1000 +  ...
chisq = 77.183, df = 26, p-value = 5.657e-07
alternative hypothesis: serial correlation in idiosyncratic errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preusch-Pagan Test mit ASE-Korrektur</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtestPCSE</span>(model_fe_lag) <span class="co"># Korrektur hilft gegen Autokorrelation, wird durch LDV aber nicht besser</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in get(.Generic)(e1, e2): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 1

data:  resid_adj ~ fitted.values(model)
LM test = 0.29265, df = 1, p-value = 0.5885</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Model with ASE Correction</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>model_feLDV_PCSE <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_lag, <span class="at">vcov=</span><span class="fu">vcovSCC</span>(model_fe_lag, <span class="at">cluster =</span> <span class="st">"time"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-regtable-a1-with-model-comparison" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="create-regtable-a1-with-model-comparison"><span class="header-section-number">5.3.5</span> Create RegTable A1 with Model Comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a regtable with the results</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model_fe, model_fe, model_fe, model_fe_lag, <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> <span class="fu">list</span>(model_feASE[,<span class="dv">2</span>], model_fePCSE[,<span class="dv">2</span>], model_feDKSE[,<span class="dv">2</span>], model_feLDV_PCSE[,<span class="dv">2</span>]),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> <span class="fu">list</span>(model_feASE[,<span class="dv">4</span>], model_fePCSE[,<span class="dv">4</span>], model_feDKSE[,<span class="dv">4</span>], model_feLDV_PCSE[,<span class="dv">4</span>]),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">"LDV"</span>, <span class="st">"TaxRev Einkommen"</span>, <span class="st">"TaxRev EIG"</span>, <span class="st">"TaxRev Eigentum"</span>, <span class="st">"TaxRev Nettovermögen"</span>, <span class="st">"TaxRev Anteil an BIP"</span>, <span class="st">"Liberaler Demokratieindex"</span>, <span class="st">"Bildungsgleichheit"</span>, <span class="st">"BIP"</span>, <span class="st">"Arbeitslosenrate"</span>), <span class="co"># Replace with your new covariate names</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">"Arellano"</span>, <span class="st">"PCSE"</span>, <span class="st">"Driscoll/Kraay"</span>, <span class="st">"LDV+PCSE"</span>) <span class="co"># Replace with your new column names</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>          <span class="co">#, out = "manuscript/tables/tableA1.tex"</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================================================================================
                                                                 Dependent variable:                                       
                          -------------------------------------------------------------------------------------------------
                                                                     Wealth_Gini                                           
                                 Arellano                  PCSE               Driscoll/Kraay              LDV+PCSE         
                                    (1)                     (2)                     (3)                      (4)           
---------------------------------------------------------------------------------------------------------------------------
LDV                                                                                                       0.905***         
                                                                                                           (0.025)         
                                                                                                                           
TaxRev Einkommen                  0.0001                  0.0001                  0.0001                  -0.00003         
                                  (0.001)                (0.0003)                 (0.001)                 (0.0001)         
                                                                                                                           
TaxRev EIG                        -0.015                 -0.015**                 -0.015*                  -0.004*         
                                  (0.012)                 (0.006)                 (0.008)                  (0.002)         
                                                                                                                           
TaxRev Eigentum                  0.015***                0.015***                0.015***                   0.001          
                                  (0.005)                 (0.001)                 (0.002)                  (0.001)         
                                                                                                                           
TaxRev Nettovermögen              -0.008                 -0.008**                 -0.008*                   0.002          
                                  (0.009)                 (0.004)                 (0.005)                  (0.002)         
                                                                                                                           
TaxRev Anteil an BIP               0.002                 0.002***                0.002***                  0.0001          
                                  (0.002)                (0.0004)                (0.0004)                 (0.0001)         
                                                                                                                           
Liberaler Demokratieindex        -0.089**                -0.089***               -0.089***                -0.019***        
                                  (0.040)                 (0.012)                 (0.019)                  (0.005)         
                                                                                                                           
Bildungsgleichheit                 0.010                 0.010***                0.010***                   0.001          
                                  (0.012)                 (0.002)                 (0.002)                  (0.001)         
                                                                                                                           
BIP                               0.00000                 0.00000                 0.00000                 -0.00000*        
                                 (0.00000)               (0.00000)               (0.00000)                (0.00000)        
                                                                                                                           
Arbeitslosenrate                   0.001                  0.001**                  0.001                  0.001***         
                                  (0.001)                (0.0003)                (0.0005)                 (0.0001)         
                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------
Observations                        621                     621                     621                      598           
R2                                 0.334                   0.334                   0.334                    0.902          
Adjusted R2                        0.299                   0.299                   0.299                    0.897          
F Statistic               32.769*** (df = 9; 589) 32.769*** (df = 9; 589) 32.769*** (df = 9; 589) 522.386*** (df = 10; 565)
===========================================================================================================================
Note:                                                                                           *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Achtung: LDV Werte müssen teilweise manuell entfernt werden</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="main-model-stack" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="main-model-stack"><span class="header-section-number">5.4</span> Main Model Stack</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Main Models (Wealth Gini as DP)</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - Minimal Model</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>model_fe_1 <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300, </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300, data = equaltax, 
    effect = "individual", model = "within", index = c("Country", 
        "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-0.09766613 -0.00828193 -0.00049306  0.00955476  0.09209880 

Coefficients:
                  Estimate Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300 -0.0311671  0.0059076 -5.2757 1.853e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.29474
Residual Sum of Squares: 0.28161
R-Squared:      0.044545
Adj. R-Squared: 0.0077352
F-statistic: 27.8332 on 1 and 597 DF, p-value: 1.8525e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - First-Control Model</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>model_fe_2 <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP, </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300 + TaxRev_Income_IPC_1000 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP, 
    data = equaltax, effect = "individual", model = "within", 
    index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-0.08283591 -0.00822245 -0.00068448  0.00963446  0.06453006 

Coefficients:
                          Estimate  Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300        -0.02090362  0.00513956 -4.0672 5.401e-05 ***
TaxRev_Income_IPC_1000 -0.00010396  0.00036247 -0.2868    0.7744    
TaxRev_ImmovProp_4100   0.01546280  0.00123405 12.5301 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -0.00372516  0.00359499 -1.0362    0.3005    
TaxRev_TotalofGDP       0.00223743  0.00043887  5.0982 4.618e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.29474
Residual Sum of Squares: 0.20679
R-Squared:      0.29839
Adj. R-Squared: 0.26645
F-statistic: 50.4406 on 5 and 593 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - Extended-Control Model</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>model_fe_3 <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq, </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300 + TaxRev_Income_IPC_1000 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq, data = equaltax, effect = "individual", 
    model = "within", index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-8.2773e-02 -8.8141e-03 -2.0452e-05  1.0612e-02  6.2750e-02 

Coefficients:
                          Estimate  Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300        -1.7792e-02  5.0998e-03 -3.4887 0.0005214 ***
TaxRev_Income_IPC_1000  7.5284e-05  3.6444e-04  0.2066 0.8364128    
TaxRev_ImmovProp_4100   1.6158e-02  1.2237e-03 13.2043 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -6.6172e-03  3.5687e-03 -1.8542 0.0642040 .  
TaxRev_TotalofGDP       2.0500e-03  4.3240e-04  4.7410 2.668e-06 ***
v2x_libdem             -7.6751e-02  1.7222e-02 -4.4565 9.968e-06 ***
v2peedueq               1.0930e-02  3.2237e-03  3.3906 0.0007439 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.29474
Residual Sum of Squares: 0.19799
R-Squared:      0.32823
Adj. R-Squared: 0.29527
F-statistic: 41.2523 on 7 and 591 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - Extended-Control Model Plus</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>model_fe_4 <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate, </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300 + TaxRev_Income_IPC_1000 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq + GDP_constant_billions + Unemployment_rate, 
    data = equaltax, effect = "individual", model = "within", 
    index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.0838587 -0.0090261  0.0001897  0.0101500  0.0634268 

Coefficients:
                          Estimate  Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300        -1.4781e-02  5.5934e-03 -2.6425  0.008448 ** 
TaxRev_Income_IPC_1000  1.0848e-04  3.6592e-04  0.2964  0.766994    
TaxRev_ImmovProp_4100   1.4714e-02  1.4004e-03 10.5070 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -7.8344e-03  3.6076e-03 -2.1716  0.030282 *  
TaxRev_TotalofGDP       2.0343e-03  4.3264e-04  4.7020 3.212e-06 ***
v2x_libdem             -8.8734e-02  1.8057e-02 -4.9140 1.158e-06 ***
v2peedueq               1.0331e-02  3.2562e-03  3.1727  0.001589 ** 
GDP_constant_billions   4.8499e-07  1.4593e-06  0.3324  0.739738    
Unemployment_rate       7.1895e-04  3.2865e-04  2.1876  0.029094 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.29474
Residual Sum of Squares: 0.1964
R-Squared:      0.33365
Adj. R-Squared: 0.29858
F-statistic: 32.7691 on 9 and 589 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
<section id="regtable-of-main-models-1-4" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="regtable-of-main-models-1-4"><span class="header-section-number">5.4.1</span> RegTable of Main Models 1-4</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute panel-corrected standard errors</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>pcse_1 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_1, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_1, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>pcse_2 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_2, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_2, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>pcse_3 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_3, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_3, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>pcse_4 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_4, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_4, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model_fe_1, model_fe_2, model_fe_3, model_fe_4, <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> <span class="fu">list</span>(pcse_1[,<span class="dv">2</span>], pcse_2[,<span class="dv">2</span>], pcse_3[,<span class="dv">2</span>], pcse_4[,<span class="dv">2</span>]),</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> <span class="fu">list</span>(pcse_1[,<span class="dv">4</span>], pcse_2[,<span class="dv">4</span>], pcse_3[,<span class="dv">4</span>], pcse_4[,<span class="dv">4</span>]),</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">"TaxRev EIG"</span>, <span class="st">"TaxRev Einkommen"</span>, <span class="st">"TaxRev Eigentum"</span>, <span class="st">"TaxRev Nettovermögen"</span>, <span class="st">"TaxRev Anteil an BIP"</span>, <span class="st">"Liberaler Demokratieindex"</span>, <span class="st">"Bildungsgleichheit"</span>, <span class="st">"BIP"</span>, <span class="st">"Arbeitslosenrate"</span>) <span class="co"># Replace with your new covariate names</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>          <span class="co">#, out = "manuscript/tables/table2.tex"</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=========================================================================================================================
                                                                Dependent variable:                                      
                          -----------------------------------------------------------------------------------------------
                                                                    Wealth_Gini                                          
                                    (1)                     (2)                     (3)                     (4)          
-------------------------------------------------------------------------------------------------------------------------
TaxRev EIG                       -0.031***               -0.021***               -0.018***               -0.015**        
                                  (0.007)                 (0.005)                 (0.005)                 (0.006)        
                                                                                                                         
TaxRev Einkommen                                          -0.0001                 0.0001                  0.0001         
                                                         (0.0003)                (0.0003)                (0.0003)        
                                                                                                                         
TaxRev Eigentum                                          0.015***                0.016***                0.015***        
                                                          (0.001)                 (0.001)                 (0.001)        
                                                                                                                         
TaxRev Nettovermögen                                      -0.004                  -0.007*                -0.008**        
                                                          (0.004)                 (0.004)                 (0.004)        
                                                                                                                         
TaxRev Anteil an BIP                                     0.002***                0.002***                0.002***        
                                                         (0.0004)                (0.0004)                (0.0004)        
                                                                                                                         
Liberaler Demokratieindex                                                        -0.077***               -0.089***       
                                                                                  (0.009)                 (0.012)        
                                                                                                                         
Bildungsgleichheit                                                               0.011***                0.010***        
                                                                                  (0.002)                 (0.002)        
                                                                                                                         
BIP                                                                                                       0.00000        
                                                                                                         (0.00000)       
                                                                                                                         
Arbeitslosenrate                                                                                          0.001**        
                                                                                                         (0.0003)        
                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------
Observations                        621                     621                     621                     621          
R2                                 0.045                   0.298                   0.328                   0.334         
Adjusted R2                        0.008                   0.266                   0.295                   0.299         
F Statistic               27.833*** (df = 1; 597) 50.441*** (df = 5; 593) 41.252*** (df = 7; 591) 32.769*** (df = 9; 589)
=========================================================================================================================
Note:                                                                                         *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
</section>
<section id="wealth-model-stack---minimal-dataset--standarized-models" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="wealth-model-stack---minimal-dataset--standarized-models"><span class="header-section-number">5.5</span> Wealth Model Stack - Minimal Dataset- Standarized Models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>equaltax_std <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(equaltax[, <span class="fu">c</span>(<span class="st">"Wealth_Gini"</span>, <span class="st">"TaxRev_Income_IPC_1000"</span>, <span class="st">"TaxRev_EIG_4300"</span>, <span class="st">"TaxRev_ImmovProp_4100"</span>, <span class="st">"TaxRev_NetWealth_4200"</span>, <span class="st">"TaxRev_TotalofGDP"</span>, <span class="st">"v2x_libdem"</span>, <span class="st">"v2peedueq"</span>, <span class="st">"GDP_constant_billions"</span>, <span class="st">"Unemployment_rate"</span>)]))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the 'Country' and 'Year' columns back to the dataframe</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>equaltax_std<span class="sc">$</span>Country <span class="ot">&lt;-</span> equaltax<span class="sc">$</span>Country</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>equaltax_std<span class="sc">$</span>Year <span class="ot">&lt;-</span> equaltax<span class="sc">$</span>Year</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the models with the standardized variables</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - Minimal Model</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>model_fe_1_std <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300, </span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax_std, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_1_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300, data = equaltax_std, 
    effect = "individual", model = "within", index = c("Country", 
        "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.8249852 -0.1547557 -0.0092133  0.1785399  1.7209542 

Coefficients:
                 Estimate Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300 -0.248184   0.047043 -5.2757 1.853e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    102.91
Residual Sum of Squares: 98.327
R-Squared:      0.044545
Adj. R-Squared: 0.0077352
F-statistic: 27.8332 on 1 and 597 DF, p-value: 1.8525e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - First-Control Model</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>model_fe_2_std <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP, </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax_std, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_2_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300 + TaxRev_Income_IPC_1000 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP, 
    data = equaltax_std, effect = "individual", model = "within", 
    index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
    Min.  1st Qu.   Median  3rd Qu.     Max. 
-1.54787 -0.15364 -0.01279  0.18003  1.20581 

Coefficients:
                        Estimate Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300        -0.166456   0.040926 -4.0672 5.401e-05 ***
TaxRev_Income_IPC_1000 -0.020266   0.070661 -0.2868    0.7744    
TaxRev_ImmovProp_4100   0.853475   0.068114 12.5301 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -0.068384   0.065995 -1.0362    0.3005    
TaxRev_TotalofGDP       0.269359   0.052834  5.0982 4.618e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    102.91
Residual Sum of Squares: 72.203
R-Squared:      0.29839
Adj. R-Squared: 0.26645
F-statistic: 50.4406 on 5 and 593 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - Extended-Control Model</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>model_fe_3_std <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq, </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax_std, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_3_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300 + TaxRev_Income_IPC_1000 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq, data = equaltax_std, effect = "individual", 
    model = "within", index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.54668395 -0.16469917 -0.00038216  0.19829860  1.17255136 

Coefficients:
                        Estimate Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300        -0.141677   0.040610 -3.4887 0.0005214 ***
TaxRev_Income_IPC_1000  0.014676   0.071044  0.2066 0.8364128    
TaxRev_ImmovProp_4100   0.891838   0.067542 13.2043 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -0.121475   0.065512 -1.8542 0.0642040 .  
TaxRev_TotalofGDP       0.246794   0.052055  4.7410 2.668e-06 ***
v2x_libdem             -0.101781   0.022839 -4.4565 9.968e-06 ***
v2peedueq               0.135587   0.039989  3.3906 0.0007439 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    102.91
Residual Sum of Squares: 69.133
R-Squared:      0.32823
Adj. R-Squared: 0.29527
F-statistic: 41.2523 on 7 and 591 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - Extended-Control Model Plus</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>model_fe_4_std <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax_std, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fe_4_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ TaxRev_EIG_4300 + TaxRev_Income_IPC_1000 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq + GDP_constant_billions + Unemployment_rate, 
    data = equaltax_std, effect = "individual", model = "within", 
    index = c("Country", "Year"))

Balanced Panel: n = 23, T = 27, N = 621

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.5669793 -0.1686617  0.0035447  0.1896617  1.1851902 

Coefficients:
                        Estimate Std. Error t-value  Pr(&gt;|t|)    
TaxRev_EIG_4300        -0.117698   0.044540 -2.6425  0.008448 ** 
TaxRev_Income_IPC_1000  0.021146   0.071333  0.2964  0.766994    
TaxRev_ImmovProp_4100   0.812167   0.077298 10.5070 &lt; 2.2e-16 ***
TaxRev_NetWealth_4200  -0.143819   0.066226 -2.1716  0.030282 *  
TaxRev_TotalofGDP       0.244902   0.052085  4.7020 3.212e-06 ***
v2x_libdem             -0.117673   0.023946 -4.9140 1.158e-06 ***
v2peedueq               0.128149   0.040392  3.1727  0.001589 ** 
GDP_constant_billions   0.029960   0.090143  0.3324  0.739738    
Unemployment_rate       0.057410   0.026244  2.1876  0.029094 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    102.91
Residual Sum of Squares: 68.575
R-Squared:      0.33365
Adj. R-Squared: 0.29858
F-statistic: 32.7691 on 9 and 589 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
<section id="regtable-of-standardized-models-1-4" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="regtable-of-standardized-models-1-4"><span class="header-section-number">5.5.1</span> RegTable of Standardized Models 1-4</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute panel-corrected standard errors</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>pcse_1_std <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_1_std, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_1_std, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>pcse_2_std <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_2_std, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_2_std, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>pcse_3_std <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_3_std, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_3_std, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>pcse_4_std <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_fe_4_std, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_fe_4_std, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the regression table with stargazer</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model_fe_1_std, model_fe_2_std, model_fe_3_std, model_fe_4_std, <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> <span class="fu">list</span>(pcse_1_std[,<span class="dv">2</span>], pcse_2_std[,<span class="dv">2</span>], pcse_3_std[,<span class="dv">2</span>], pcse_4_std[,<span class="dv">2</span>]),</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> <span class="fu">list</span>(pcse_1_std[,<span class="dv">4</span>], pcse_2_std[,<span class="dv">4</span>], pcse_3_std[,<span class="dv">4</span>], pcse_4_std[,<span class="dv">4</span>]),</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">"TaxRev EIG"</span>, <span class="st">"TaxRev Einkommen"</span>, <span class="st">"TaxRev Eigentum"</span>, <span class="st">"TaxRev Nettovermögen"</span>, <span class="st">"TaxRev Anteil an BIP"</span>, <span class="st">"Liberaler Demokratieindex"</span>, <span class="st">"Bildungsgleichheit"</span>, <span class="st">"BIP"</span>, <span class="st">"Arbeitslosenrate"</span>) <span class="co"># Replace with your new covariate names</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>          <span class="co">#, out = "manuscript/tables/tableA2.tex"</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=========================================================================================================================
                                                                Dependent variable:                                      
                          -----------------------------------------------------------------------------------------------
                                                                    Wealth_Gini                                          
                                    (1)                     (2)                     (3)                     (4)          
-------------------------------------------------------------------------------------------------------------------------
TaxRev EIG                       -0.248***               -0.166***               -0.142***               -0.118**        
                                  (0.055)                 (0.042)                 (0.042)                 (0.048)        
                                                                                                                         
TaxRev Einkommen                                          -0.020                   0.015                   0.021         
                                                          (0.063)                 (0.067)                 (0.067)        
                                                                                                                         
TaxRev Eigentum                                          0.853***                0.892***                0.812***        
                                                          (0.074)                 (0.076)                 (0.069)        
                                                                                                                         
TaxRev Nettovermögen                                      -0.068                  -0.121*                -0.144**        
                                                          (0.076)                 (0.067)                 (0.069)        
                                                                                                                         
TaxRev Anteil an BIP                                     0.269***                0.247***                0.245***        
                                                          (0.044)                 (0.045)                 (0.044)        
                                                                                                                         
Liberaler Demokratieindex                                                        -0.102***               -0.118***       
                                                                                  (0.012)                 (0.016)        
                                                                                                                         
Bildungsgleichheit                                                               0.136***                0.128***        
                                                                                  (0.029)                 (0.030)        
                                                                                                                         
BIP                                                                                                        0.030         
                                                                                                          (0.072)        
                                                                                                                         
Arbeitslosenrate                                                                                          0.057**        
                                                                                                          (0.025)        
                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------
Observations                        621                     621                     621                     621          
R2                                 0.045                   0.298                   0.328                   0.334         
Adjusted R2                        0.008                   0.266                   0.295                   0.299         
F Statistic               27.833*** (df = 1; 597) 50.441*** (df = 5; 593) 41.252*** (df = 7; 591) 32.769*** (df = 9; 589)
=========================================================================================================================
Note:                                                                                         *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
</section>
<section id="alternative-lag-tests" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="alternative-lag-tests"><span class="header-section-number">5.6</span> Alternative Lag Tests</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed_data"</span>, <span class="st">"equaltax_balanced.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 621 Columns: 21
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(1): Country dbl (20): ...1, ...2, Year, TaxRev_Income_IPC_1000,
TaxRev_Social_SSC_2000, ...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
• `...1` -&gt; `...2`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - Lag3-Model</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>model_alt_1 <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> <span class="fu">lag</span>(TaxRev_EIG_4300, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_Income_IPC_1000, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_ImmovProp_4100, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_NetWealth_4200, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_TotalofGDP, <span class="dv">3</span>) <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> Unemployment_rate <span class="sc">+</span> GDP_constant_billions, </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_alt_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ lag(TaxRev_EIG_4300, 3) + lag(TaxRev_Income_IPC_1000, 
    3) + lag(TaxRev_ImmovProp_4100, 3) + lag(TaxRev_NetWealth_4200, 
    3) + lag(TaxRev_TotalofGDP, 3) + v2x_libdem + v2peedueq + 
    Unemployment_rate + GDP_constant_billions, data = equaltax, 
    effect = "individual", model = "within", index = c("Country", 
        "Year"))

Balanced Panel: n = 23, T = 24, N = 552

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-0.08058802 -0.00757942  0.00073437  0.00907179  0.05654830 

Coefficients:
                                  Estimate  Std. Error t-value  Pr(&gt;|t|)    
lag(TaxRev_EIG_4300, 3)        -2.4077e-02  5.5154e-03 -4.3653 1.532e-05 ***
lag(TaxRev_Income_IPC_1000, 3) -5.0791e-04  3.7536e-04 -1.3531 0.1766051    
lag(TaxRev_ImmovProp_4100, 3)   1.2148e-02  1.2636e-03  9.6138 &lt; 2.2e-16 ***
lag(TaxRev_NetWealth_4200, 3)   2.3398e-04  3.4666e-03  0.0675 0.9462124    
lag(TaxRev_TotalofGDP, 3)       2.2658e-03  4.8347e-04  4.6866 3.552e-06 ***
v2x_libdem                     -8.7988e-02  1.7283e-02 -5.0910 4.987e-07 ***
v2peedueq                       1.1847e-02  3.2469e-03  3.6489 0.0002899 ***
Unemployment_rate               2.0286e-03  2.8250e-04  7.1809 2.409e-12 ***
GDP_constant_billions          -1.2466e-06  1.6831e-06 -0.7406 0.4592442    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.23889
Residual Sum of Squares: 0.14325
R-Squared:      0.40033
Adj. R-Squared: 0.36458
F-statistic: 38.5718 on 9 and 520 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - Lag5-Model</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>model_alt_2 <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> <span class="fu">lag</span>(TaxRev_EIG_4300, <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_Income_IPC_1000, <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_ImmovProp_4100, <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_NetWealth_4200, <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_TotalofGDP, <span class="dv">5</span>) <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> Unemployment_rate <span class="sc">+</span> GDP_constant_billions, </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_alt_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ lag(TaxRev_EIG_4300, 5) + lag(TaxRev_Income_IPC_1000, 
    5) + lag(TaxRev_ImmovProp_4100, 5) + lag(TaxRev_NetWealth_4200, 
    5) + lag(TaxRev_TotalofGDP, 5) + v2x_libdem + v2peedueq + 
    Unemployment_rate + GDP_constant_billions, data = equaltax, 
    effect = "individual", model = "within", index = c("Country", 
        "Year"))

Balanced Panel: n = 23, T = 22, N = 506

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-0.08451757 -0.00754662  0.00062598  0.00849250  0.05941303 

Coefficients:
                                  Estimate  Std. Error t-value  Pr(&gt;|t|)    
lag(TaxRev_EIG_4300, 5)        -2.9905e-02  5.3150e-03 -5.6266 3.148e-08 ***
lag(TaxRev_Income_IPC_1000, 5) -9.6171e-04  3.6670e-04 -2.6226 0.0090073 ** 
lag(TaxRev_ImmovProp_4100, 5)   1.1412e-02  1.2319e-03  9.2637 &lt; 2.2e-16 ***
lag(TaxRev_NetWealth_4200, 5)   2.5122e-03  3.3319e-03  0.7540 0.4512336    
lag(TaxRev_TotalofGDP, 5)       1.9887e-03  5.0981e-04  3.9009 0.0001097 ***
v2x_libdem                     -8.8141e-02  1.6373e-02 -5.3833 1.153e-07 ***
v2peedueq                       1.1707e-02  3.1136e-03  3.7600 0.0001911 ***
Unemployment_rate               2.7545e-03  2.5855e-04 10.6534 &lt; 2.2e-16 ***
GDP_constant_billions          -2.3451e-06  1.8191e-06 -1.2892 0.1979654    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.2006
Residual Sum of Squares: 0.10948
R-Squared:      0.45421
Adj. R-Squared: 0.41852
F-statistic: 43.8302 on 9 and 474 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - Reverse-Lag5</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>model_alt_3 <span class="ot">&lt;-</span> <span class="fu">plm</span>(Wealth_Gini <span class="sc">~</span> <span class="fu">lag</span>(TaxRev_EIG_4300, <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_Income_IPC_1000, <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_ImmovProp_4100, <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_NetWealth_4200, <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">lag</span>(TaxRev_TotalofGDP, <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> Unemployment_rate <span class="sc">+</span> GDP_constant_billions, </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_alt_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Wealth_Gini ~ lag(TaxRev_EIG_4300, -5) + lag(TaxRev_Income_IPC_1000, 
    -5) + lag(TaxRev_ImmovProp_4100, -5) + lag(TaxRev_NetWealth_4200, 
    -5) + lag(TaxRev_TotalofGDP, -5) + v2x_libdem + v2peedueq + 
    Unemployment_rate + GDP_constant_billions, data = equaltax, 
    effect = "individual", model = "within", index = c("Country", 
        "Year"))

Balanced Panel: n = 23, T = 22, N = 506

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-0.08933970 -0.00693380  0.00029342  0.00693601  0.06907971 

Coefficients:
                                   Estimate  Std. Error t-value  Pr(&gt;|t|)    
lag(TaxRev_EIG_4300, -5)         8.5352e-03  7.2426e-03  1.1785 0.2392008    
lag(TaxRev_Income_IPC_1000, -5) -6.6936e-04  4.3207e-04 -1.5492 0.1220028    
lag(TaxRev_ImmovProp_4100, -5)   6.0138e-03  1.3788e-03  4.3616 1.585e-05 ***
lag(TaxRev_NetWealth_4200, -5)  -3.7792e-03  4.2716e-03 -0.8847 0.3767518    
lag(TaxRev_TotalofGDP, -5)       2.0318e-03  4.8210e-04  4.2144 3.000e-05 ***
v2x_libdem                      -2.9595e-02  3.1198e-02 -0.9486 0.3432976    
v2peedueq                        4.1276e-03  5.2988e-03  0.7790 0.4363840    
Unemployment_rate                1.9422e-03  2.9240e-04  6.6424 8.482e-11 ***
GDP_constant_billions            6.6425e-06  1.9037e-06  3.4893 0.0005294 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.18441
Residual Sum of Squares: 0.14381
R-Squared:      0.22016
Adj. R-Squared: 0.16916
F-statistic: 14.8685 on 9 and 474 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - Reverse Lag5+Extended-Control Model</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>model_alt_4 <span class="ot">&lt;-</span> <span class="fu">plm</span>(TaxRev_EIG_4300 <span class="sc">~</span> <span class="fu">lag</span>(Wealth_Gini, <span class="dv">5</span>), </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_alt_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = TaxRev_EIG_4300 ~ lag(Wealth_Gini, 5), data = equaltax, 
    effect = "individual", model = "within", index = c("Country", 
        "Year"))

Balanced Panel: n = 23, T = 22, N = 506

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-0.431503 -0.056380 -0.011241  0.055145  0.501438 

Coefficients:
                    Estimate Std. Error t-value Pr(&gt;|t|)
lag(Wealth_Gini, 5) -0.39597    0.28285 -1.3999   0.1622

Total Sum of Squares:    7.1402
Residual Sum of Squares: 7.1113
R-Squared:      0.0040496
Adj. R-Squared: -0.043475
F-statistic: 1.95983 on 1 and 482 DF, p-value: 0.16218</code></pre>
</div>
</div>
<section id="regtable-of-causality-models-1-4" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="regtable-of-causality-models-1-4"><span class="header-section-number">5.6.1</span> RegTable of Causality Models 1-4</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute panel-corrected standard errors</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>pcse_alt1 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_alt_1, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_alt_1, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>pcse_alt2 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_alt_2, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_alt_2, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>pcse_alt3 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_alt_3, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_alt_3, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>pcse_alt4 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_alt_4, <span class="at">vcov=</span><span class="fu">vcovBK</span>(model_alt_4, <span class="at">cluster =</span> <span class="st">"time"</span>))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the regression table with stargazer</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model_alt_1, model_alt_2, model_alt_3, model_alt_4, <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> <span class="fu">list</span>(pcse_alt1[,<span class="dv">2</span>], pcse_alt2[,<span class="dv">2</span>], pcse_alt3[,<span class="dv">2</span>], pcse_alt4[,<span class="dv">2</span>]),</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">p =</span> <span class="fu">list</span>(pcse_alt1[,<span class="dv">4</span>], pcse_alt2[,<span class="dv">4</span>], pcse_alt3[,<span class="dv">4</span>], pcse_alt4[,<span class="dv">4</span>])</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>          <span class="co"># covariate.labels = c("TaxRev Einkommen", "TaxRev EIG", "TaxRev Eigentum", "TaxRev Nettovermögen", "TaxRev Anteil an BIP", "Liberaler Demokratieindex", "Bildungsgleichheit", "BIP", "Arbeitslosenrate"), # Replace with your new covariate names</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>          <span class="co">#, out = "manuscript/tables/tableA3.tex"</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================================================================================
                                                                    Dependent variable:                                    
                                -------------------------------------------------------------------------------------------
                                                              Wealth_Gini                                   TaxRev_EIG_4300    
                                          (1)                     (2)                     (3)                   (4)        
---------------------------------------------------------------------------------------------------------------------------
lag(TaxRev_EIG_4300, 3)                -0.024***                                                                           
                                        (0.005)                                                                            
                                                                                                                           
lag(TaxRev_Income_IPC_1000, 3)          -0.001                                                                             
                                       (0.0003)                                                                            
                                                                                                                           
lag(TaxRev_ImmovProp_4100, 3)          0.012***                                                                            
                                        (0.001)                                                                            
                                                                                                                           
lag(TaxRev_NetWealth_4200, 3)           0.0002                                                                             
                                        (0.004)                                                                            
                                                                                                                           
lag(TaxRev_TotalofGDP, 3)              0.002***                                                                            
                                       (0.0005)                                                                            
                                                                                                                           
lag(TaxRev_EIG_4300, 5)                                        -0.030***                                                   
                                                                (0.005)                                                    
                                                                                                                           
lag(TaxRev_Income_IPC_1000, 5)                                 -0.001***                                                   
                                                               (0.0003)                                                    
                                                                                                                           
lag(TaxRev_ImmovProp_4100, 5)                                  0.011***                                                    
                                                                (0.002)                                                    
                                                                                                                           
lag(TaxRev_NetWealth_4200, 5)                                    0.003                                                     
                                                                (0.004)                                                    
                                                                                                                           
lag(TaxRev_TotalofGDP, 5)                                      0.002***                                                    
                                                                (0.001)                                                    
                                                                                                                           
lag(TaxRev_EIG_4300, -5)                                                                 0.009                             
                                                                                        (0.007)                            
                                                                                                                           
lag(TaxRev_Income_IPC_1000, -5)                                                         -0.001*                            
                                                                                       (0.0004)                            
                                                                                                                           
lag(TaxRev_ImmovProp_4100, -5)                                                         0.006***                            
                                                                                        (0.002)                            
                                                                                                                           
lag(TaxRev_NetWealth_4200, -5)                                                          -0.004                             
                                                                                        (0.005)                            
                                                                                                                           
lag(TaxRev_TotalofGDP, -5)                                                             0.002***                            
                                                                                       (0.0004)                            
                                                                                                                           
v2x_libdem                             -0.088***               -0.088***                -0.030                             
                                        (0.012)                 (0.012)                 (0.020)                            
                                                                                                                           
v2peedueq                              0.012***                0.012***                  0.004                             
                                        (0.003)                 (0.003)                 (0.003)                            
                                                                                                                           
Unemployment_rate                      0.002***                0.003***                0.002***                            
                                       (0.0003)                (0.0003)                (0.0004)                            
                                                                                                                           
GDP_constant_billions                  -0.00000               -0.00000**              0.00001***                           
                                       (0.00000)               (0.00000)               (0.00000)                           
                                                                                                                           
lag(Wealth_Gini, 5)                                                                                           -0.396       
                                                                                                              (0.372)      
                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------
Observations                              552                     506                     506                   506        
R2                                       0.400                   0.454                   0.220                 0.004       
Adjusted R2                              0.365                   0.419                   0.169                -0.043       
F Statistic                     38.572*** (df = 9; 520) 43.830*** (df = 9; 474) 14.868*** (df = 9; 474) 1.960 (df = 1; 482)
===========================================================================================================================
Note:                                                                                           *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="additional-regression-diagnostics" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Additional Regression diagnostics</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Wealth_Gini <span class="sc">~</span> TaxRev_Income_IPC_1000 <span class="sc">+</span> TaxRev_EIG_4300 <span class="sc">+</span> TaxRev_ImmovProp_4100 <span class="sc">+</span> TaxRev_NetWealth_4200 <span class="sc">+</span> TaxRev_TotalofGDP <span class="sc">+</span> v2x_libdem <span class="sc">+</span> v2peedueq <span class="sc">+</span> GDP_constant_billions <span class="sc">+</span> Unemployment_rate, </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> equaltax)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Wealth_Gini ~ TaxRev_Income_IPC_1000 + TaxRev_EIG_4300 + 
    TaxRev_ImmovProp_4100 + TaxRev_NetWealth_4200 + TaxRev_TotalofGDP + 
    v2x_libdem + v2peedueq + GDP_constant_billions + Unemployment_rate, 
    data = equaltax)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.147208 -0.029466 -0.004975  0.019286  0.160309 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             9.361e-01  2.411e-02  38.829  &lt; 2e-16 ***
TaxRev_Income_IPC_1000  9.793e-04  2.389e-04   4.099 4.72e-05 ***
TaxRev_EIG_4300        -3.480e-02  5.197e-03  -6.697 4.84e-11 ***
TaxRev_ImmovProp_4100  -3.425e-03  9.594e-04  -3.569 0.000386 ***
TaxRev_NetWealth_4200  -7.436e-03  2.195e-03  -3.388 0.000749 ***
TaxRev_TotalofGDP      -3.227e-03  3.423e-04  -9.428  &lt; 2e-16 ***
v2x_libdem             -1.137e-01  3.160e-02  -3.597 0.000348 ***
v2peedueq              -3.179e-03  3.839e-03  -0.828 0.407871    
GDP_constant_billions   3.598e-06  8.479e-07   4.244 2.54e-05 ***
Unemployment_rate       2.093e-03  4.664e-04   4.487 8.63e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.04473 on 611 degrees of freedom
Multiple R-squared:  0.3115,    Adjusted R-squared:  0.3013 
F-statistic: 30.71 on 9 and 611 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for multicollinearity</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">check_collinearity</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

                   Term  VIF   VIF 95% CI Increased SE Tolerance
 TaxRev_Income_IPC_1000 1.93 [1.73, 2.17]         1.39      0.52
        TaxRev_EIG_4300 1.52 [1.38, 1.70]         1.23      0.66
  TaxRev_ImmovProp_4100 2.49 [2.21, 2.83]         1.58      0.40
  TaxRev_NetWealth_4200 1.44 [1.32, 1.61]         1.20      0.69
      TaxRev_TotalofGDP 1.51 [1.37, 1.69]         1.23      0.66
             v2x_libdem 1.56 [1.42, 1.75]         1.25      0.64
              v2peedueq 2.01 [1.80, 2.27]         1.42      0.50
  GDP_constant_billions 2.43 [2.17, 2.77]         1.56      0.41
      Unemployment_rate 1.23 [1.14, 1.38]         1.11      0.81
 Tolerance 95% CI
     [0.46, 0.58]
     [0.59, 0.72]
     [0.35, 0.45]
     [0.62, 0.76]
     [0.59, 0.73]
     [0.57, 0.71]
     [0.44, 0.55]
     [0.36, 0.46]
     [0.73, 0.88]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>equaltax <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 2
   Country     n
   &lt;chr&gt;   &lt;int&gt;
 1 AUT        27
 2 BEL        27
 3 CAN        27
 4 CHE        27
 5 CZE        27
 6 DEU        27
 7 DNK        27
 8 ESP        27
 9 FIN        27
10 FRA        27
11 GBR        27
12 GRC        27
13 HUN        27
14 IRL        27
15 ITA        27
16 JPN        27
17 LVA        27
18 NLD        27
19 NOR        27
20 POL        27
21 PRT        27
22 SWE        27
23 USA        27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">min</span>(equaltax<span class="sc">$</span>Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1995</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">max</span>(equaltax<span class="sc">$</span>Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2021</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>